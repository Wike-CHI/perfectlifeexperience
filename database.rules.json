{
  "rules": {
    "users": {
      ".read": "auth.openid != null && auth.openid == doc._openid",
      ".write": "auth.openid != null && auth.openid == doc._openid",
      "agentLevel": {
        ".write": "auth.openid == doc._openid && newData.agentLevel >= oldData.agentLevel"
      },
      "starLevel": {
        ".write": "auth.openid == doc._openid && newData.starLevel >= oldData.starLevel"
      },
      "_openid": {
        ".write": false
      },
      "parentId": {
        ".write": "newData.parentId == null || newData.parentId != doc._openid"
      },
      "createTime": {
        ".write": false
      },
      "updateTime": {
        ".write": false
      }
    },
    "reward_records": {
      ".read": "auth.openid == doc.beneficiaryId",
      ".write": false,
      "_openid": {
        ".write": false
      }
    },
    "promotion_orders": {
      ".read": "auth.openid == doc.buyerId || auth.openid == doc.promoterId",
      ".write": false
    },
    "promotion_relations": {
      ".read": "auth.openid == doc.parentId || auth.openid == doc.childId",
      ".write": false
    },
    "registration_attempts": {
      ".read": false,
      ".write": false
    },
    "operation_logs": {
      ".read": false,
      ".write": false
    },
    "orders": {
      ".read": "auth.openid == doc._openid",
      ".write": "auth.openid == doc._openid",
      "_openid": {
        ".write": false
      },
      "createTime": {
        ".write": false
      }
    },
    "products": {
      ".read": true,
      ".write": false
    },
    "categories": {
      ".read": true,
      ".write": false
    },
    "coupons": {
      ".read": true,
      ".write": false
    },
    "user_coupons": {
      ".read": "auth.openid == doc._openid",
      ".write": false,
      "_openid": {
        ".write": false
      },
      "status": {
        ".write": "auth.openid == doc._openid && (newData.status == 'used' || newData.status == 'expired')"
      }
    },
    "wallet_transactions": {
      ".read": "auth.openid == doc._openid",
      ".write": false,
      "_openid": {
        ".write": false
      },
      "amount": {
        ".write": false
      },
      "type": {
        ".write": false
      }
    },
    "recharge_orders": {
      ".read": "auth.openid == doc._openid",
      ".write": false
    },
    "admin_users": {
      ".read": "auth.openid != null && get('database.admin_users.' + auth.openid).is_admin == true",
      ".write": false
    },
    "system_config": {
      ".read": true,
      ".write": false
    },
    "invite_codes": {
      ".read": true,
      ".write": false
    },
    "team_stats": {
      ".read": "auth.openid != null",
      ".write": false
    }
  }
}
