# 推广体系更新总结

**更新时间**: 2026-02-23
**更新内容**: 添加下级跟随升级机制

---

## 核心更新

### 新增：跟随升级机制

当上级升级时，他原来的直接下级可以**跟随升级**，这是"下级升级脱离"的例外情况。

| 上级升级 | 下级跟随升级规则 |
|---------|----------------|
| **4→3** | 无下级跟随（但可发展新的四级） |
| **3→2** | 之前带的4级 → 3级 |
| **2→1** | 之前带的3级→2级，4级→3级 |

---

## 关键变化

### 1. 升级方式对比

| 升级类型 | 条件 | 推荐关系变化 | 下级是否跟随 |
|---------|------|-------------|------------|
| **自己升级** | 满足业绩/人数条件 | 脱离原推荐链，跳级对接上上级 | 否 |
| **跟随升级** | 上级升级触发 | 脱离原推荐链，成为上级的上级/平级 | 是（原直接下级） |

### 2. 自己升级 vs 跟随升级

**自己升级（D从四级升到三级）**：
```
升级前：A → B → C → D
升级后：A → B → D
结果：C失去D，D脱离C
```

**跟随升级（D从二级升到一级，带动C）**：
```
升级前：A → B → C → D
升级后：A → B → C(一级) 和 D(一级) 平级
结果：C跟随D升到一级，成为独立总公司
```

### 3. 培养下级的新认识

**短期看：下级自己升级，上级吃亏**
- D升三级后，C失去D的佣金（从4元变成0元）

**长期看：上级升级带动下级，双赢**
- D升一级带动C升一级
- C升二级带动E升二级
- E升二级带动F升三级
- **整个团队等级都提升了！**

---

## 模拟器更新

### 新增场景8：连续升级 + 下级跟随升级

运行方式：
```bash
node scripts/promotion-simulator.js 8        # 只运行连续升级场景
node scripts/promotion-simulator.js          # 运行所有场景
```

### 模拟器功能

1. ✅ 基础佣金分配（一级到四级）
2. ✅ 升级条件检查
3. ✅ 下级自己升级脱离机制
4. ✅ **连续升级 + 下级跟随升级**（新增）
5. ✅ 自定义订单金额
6. ✅ 佣金变化对比

---

## 文档更新

### 更新的文件

1. **[推广体系商业说明.md](../system/推广体系商业说明.md)**
   - 新增"跟随升级机制"章节
   - 更新"升级后发生什么"章节，区分自己升级和跟随升级
   - 更新"为什么要培养下级升级"章节，添加团队共赢逻辑
   - 更新"常见问题"，添加跟随升级相关问答
   - 更新"总结"，添加跟随升级机制

2. **[scripts/promotion-simulator.js](../../scripts/promotion-simulator.js)**
   - 新增场景8：连续升级 + 下级跟随升级
   - 展示完整的升级链条和跟随升级效果
   - 提供佣金变化对比

---

## 示例场景

### 场景：D从四级连续升到一级，带动整个团队

**初始状态**：
```
A(一级) → B(二级) → C(三级) → D(四级) → E(四级) → F(四级)
```

**第一步：D从四级升级到三级**
```
A(一级) → B(二级) → C(三级) → D(三级) → E(四级) → F(四级)
                      ↓
                   D脱离C，可发展新下级
```

**第二步：D从三级升级到二级，带动E升级**
```
A(一级) → B(二级) → D(二级) → 新四级
         │         ↓
         │      C(二级) → E(三级) → F(四级)
         │
         └─其他下级
```

**第三步：D从二级升级到一级，带动C和E升级**
```
D(一级) → 新二级 → 新三级 → 新四级

A(一级) → B(二级) → C(一级) → E(二级) → F(三级)
         │
         └─其他下级
```

**结果**：
- D：从四级升到一级，佣金从8元涨到20元（+150%）
- C：被D带动升到一级，佣金从12元涨到20元
- E：被C带动升到二级，佣金从8元涨到12元
- F：被E带动升到三级，佣金从8元涨到12元

**整个团队共赢！**

---

## 下一步

模拟器已完整实现推广体系的核心逻辑，包括：

1. ✅ 基础佣金分配
2. ✅ 升级条件检查
3. ✅ 下级自己升级脱离
4. ✅ 上级升级带动下级跟随

**验证通过后可以开始重构系统的推广模块。**

---

## 运行模拟器

```bash
# 运行所有场景
node scripts/promotion-simulator.js

# 只运行连续升级场景
node scripts/promotion-simulator.js 8

# 自定义订单金额
node scripts/promotion-simulator.js 288
```
